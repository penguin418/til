# ìŠ¤í”„ë§ë¶€íŠ¸

### ê°œìš”

Tomcat, Jetty, Undertowë¥¼ ë‚´ì¥, ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ build.gradle ë˜ëŠ” pom.xml ì‘ì„±ì„ ì§€ì›í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤

### ë°©ë²•

1. start.spring.ioì— ì ‘ì†

    [Spring Initializr](https://start.spring.io/)

2. gradle í˜¹ì€ mavenì„ íƒ
3. java, kotlin ì„ íƒ
4. ìŠ¤í”„ë§ ë¶€íŠ¸ ë²„ì „ ì„ íƒ
    - X.X.X : ì •ì‹ë²„ì „
    - X.X.X M : ì •ì‹ ë¦´ë¦¬ì¦ˆ ì „
    - X.X.X (Snapshot) : ì œì‘ì¤‘

    ì°¸ê³ : [https://velog.io/@yeoung004/Spring-Boot-ê³µë¶€í•˜ê¸°](https://velog.io/@yeoung004/Spring-Boot-%EA%B3%B5%EB%B6%80%ED%95%98%EA%B8%B0)

    ì°¸ê³ ë¡œ ìŠ¤í”„ë§ì˜ ë²„ì „ì€ ì•„ë˜ ì²˜ëŸ¼ ë¶„ë¥˜ë©ë‹ˆë‹¤

    - SR:(ì„œë¹„ìŠ¤ ë¦´ë¦¬ì¦ˆ):
    - GA(General Availability): ì•ˆì •ì ì¸ ë¦´ë¦¬ì¦ˆ
    - RC(ë¦´ë¦¬ìŠ¤ í›„ë³´): ë² íƒ€ë²„ì „ìœ¼ë¡œ ê³§ ì¶œì‹œ ì˜ˆì •ì¸ ì œí’ˆì…ë‹ˆë‹¤
    - M(ë§ˆì¼ìŠ¤í†¤): ê¸°ëŠ¥ì´ ì™„ì„±ë˜ì§€ ì•ŠìŒ, í•˜ì§€ë§Œ SNAPSHOTë³´ë‹¨ ì¢‹ìŠµë‹ˆë‹¤
    - SNAPSHOT(ìŠ¤ëƒ…ìƒ·): ê¸°ëŠ¥ ì œì‘ ì¤‘

    ì°¸ê³ : [https://pythonq.com/so/spring/16096](https://pythonq.com/so/spring/16096)

5. í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì„ íƒ
    - Spring Boot DevTools : ë¼ì´ë¸Œ ë¦¬ë¡œë“œë¥¼ ì§€ì›í•©ë‹ˆë‹¤
    - Lombok : 'ê·¸' `ë¡¬ë³µ`ì´ë‹¤
    - Thymeleaf : ìŠ¤í”„ë§ í…œí”Œë¦¿ ì—”ì§„, ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ì„ ì§€ì›í•©ë‹ˆë‹¤
    - Spring Security : ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ ì§€ì›í•©ë‹ˆë‹¤
6. Generate
- shareë„ ê°€ëŠ¥í•˜ë‹¤

---

# ë°°ê²½ì§€ì‹

### starter template

ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì •ë˜ë©° ê´€ë ¨ì„± ìˆëŠ” ì˜ì¡´ì„±ì„ í•œë° ëª¨ì•„ ë†“ì€ ì˜ì¡´ì„± ì»¬ë ‰ì…˜ ì…ë‹ˆë‹¤

ìì‹ ì˜ì¡´ì„±ì— ëŒ€í•´ì„œëŠ” ë²„ì „ì„ ë”°ë¡œ ì •ì˜í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤ ğŸ‰

### auto configure

ì¶”ê°€ì ì¸ ì˜ì¡´ì„± ì—†ì´ annotationë§Œìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ì €ë™ì„¤ì • ê¸°ëŠ¥ì…ë‹ˆë‹¤. 

- [XXXApplication.java](http://xxxapplication.java)ì— @EnableAutoConfiguration ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•˜ì—¬ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ```java
    @SpringBootConfiguration
    @ComponentScan("com.example")
    @EnableAutoConfiguration
    // @SpringBootApplication
    public class MyApplication { ...
    ```

    [XXXApplication.java](http://xxxapplication.java)ì—ì„œ ì¶”ê°€ëœ @SpringBootApplicationë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë¯¸ @EnableAutoConfigurationì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.(@ComponentScanê³¼ @EnableConfigurationì„ ì´ë¯¸ í¬í•¨í•¨) ë”°ë¼ì„œ @EnableAutoConfigurationì„ ì§ì ‘ êµ¬ì„±í•˜ë ¤ë©´ @SpringBootApplicationì„ ì£¼ì„ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤

auto configureëŠ” ì‚¬ìš©ì ì„¤ì •ì´ ìš°ì„ ë©ë‹ˆë‹¤

- @Comditinal, @Conditionë“±ì˜ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì„¤ì •ë˜ì–´ í•„ìš”í•œ ê²½ìš°ì—(Beansì´ ì—†ê±°ë‚˜, classpathì— íŠ¹ì • í´ë˜ìŠ¤ê°€ ì¡´ì¬í• ë—´)ë§Œ ì„¤ì •ë©ë‹ˆë‹¤
- ì–´ë–¤ í´ë˜ìŠ¤ì— auto configurationì„ ì‚¬ìš©í•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´ ë¹„í™œì„±í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤

    ```java
    @EnableAutoConfiguration(exclude={XXConfiguration.class})
    ```

auto configureë¥¼ ì‚¬ìš©í•˜ë©´ í˜„ì¬ ì„¤ì •ì„ í¬í•¨í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì„¤ì •ì„ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

- `--debug` ì˜µì…˜ê³¼ í•¨ê»˜  ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ë©´ `CONDITIONS EVALUATION REPORT`ê°€ í˜„ì¬ ì ìš©ëœ ì„¤ì •ë“¤ì„ ë³´ì—¬ì¤ë‹ˆë‹¤

ì¶œì²˜: [http://dveamer.github.io/backend/SpringBootAutoConfiguration.html](http://dveamer.github.io/backend/SpringBootAutoConfiguration.html)

### actuator

ìŠ¤í”„ë§ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤

- ì¶”ê°€ì ì¸ ì˜ì¡´ì„±ì„ ì„¤ì •í•´ì•¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

    ```tsx
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>
    ```

    ```tsx
    compile("org.springframework.boot:spring-boot-starter-actuator")
    ```

 `/actuator` í˜ì´ì§€ì—ì„œ ì§€ì›í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

```tsx
{
    "_links": {
        "self": {
            "href": "http://localhost:8080/actuator",
            "templated": false
        },
        "health": {
            "href": "http://localhost:8080/actuator/health",
            "templated": false
        },
        "info": {
            "href": "http://localhost:8080/actuator/info",
            "templated": false
        }
    }
}
```

health, infoë§Œ ì œê³µë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤

- `application.properties`ì— ë³´ì—¬ì¤„ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì¶”ê°€í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤

    ```tsx
    management.endpoints.web.exposure.include=*
    management.endpoints.web.exposure.exclude=env,beans
    ```

ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸

- `/actuator/health`

    ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤

    ApplicationContextì— ì •ì˜ëœ healthIndicatorë¥¼ ì½ì–´ì˜µë‹ˆë‹¤

- `/actuator/info`

    ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì •ë³´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤ (ì‚¬ìš©ìê°€ ì§ì ‘ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤)

- `/actuator/beans`

    ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  beansë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤

- `/actuator/configprops`

    ConfigurationPropertiesì— ê´€í•œ ì •ë³´ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤

- `/actuator/shutdown`

    ê·¸ë ˆì´ìŠ¤í’€í•˜ê²Œ ì¢…ë£Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê¸°ë³¸ì ìœ¼ë¡  ë¹„í™œì„±í™”ë¨)

    í™œì„±í™”í•˜ëŠ” ë°©ë²•

    ```java
    endpoints.shutdown.enabled=true
    ```

ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì“°ë‚˜

- ê°œë°œí• ë•ŒëŠ” intellijê°€ ìºì¹˜í•´ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤
- ì„œë¹„ìŠ¤í• ë•ŒëŠ”

    ë‹¤ë¥¸ ì‚¬ëŒë“¤ë„ ìŠ¤í”„ë§ì´ ì´ëŸ° ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì„ ì•Œê³ ìˆìŠµë‹ˆë‹¤

    ë”°ë¼ì„œ ê¸°ë³¸ ì„¤ì •ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤

    ```java
    # /actuator/hello ë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ã…‹ã…‹
    endpoints.health.id=hello

    # ì˜ˆë¥¼ë“¤ë©´ healthëŠ” ê³µê°œëœ ê²½ìš° ì„œë²„ì˜ ì •ë³´ë¥¼ ë§ì´ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ë¥¼ ê°ì¶”ê¸°ìœ„í•´ ë‹¤ìŒì˜ ì„¤ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤
    endpoints.health.sensitive=true
    ```

ì¶œì²˜: [https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/production-ready-endpoints.html](https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/production-ready-endpoints.html)

## embedded server

ê¸°ë³¸ì ìœ¼ë¡œëŠ” tomcatì„ ì‚¬ìš©í•©ë‹ˆë‹¤

- tomcat

    ìŠ¤í”„ë§ë¶€íŠ¸ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” wasì…ë‹ˆë‹¤

    ```java
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    ```

    ```java
    dependencies {
    	implementation'org.springframework.boot:spring-boot-starter-web'
    }
    ```

- jetty

    ê²½ëŸ‰ ì»¨í…Œì´ë„ˆ ì…ë‹ˆë‹¤

    ```tsx
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
        <exclusions>
            <exclusion>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-starter-tomcat</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
     
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-jetty</artifactId>
    </dependency>
    ```

    ```tsx
    configurations {
        compile.exclude module: "spring-boot-starter-tomcat"
    }

    dependencies {
        implementation 'org.springframework.boot:spring-boot-starter-web'
        implementation 'org.springframework.boot:spring-boot-starter-jetty'
    }
    ```

- undertow

    Non-blobkì„ ì§€ì›í•˜ëŠ” ê³ ì„±ëŠ¥ ì›¹ì„œë²„ì…

    ```tsx
    <dependency>
    	<groupId>org.springframework.boot</groupId>
    	<artifactId>spring-boot-starter-web</artifactId>
    	<exclusions>
    		<exclusion>
    			<groupId>org.springframework.boot</groupId>
    			<artifactId>spring-boot-starter-tomcat</artifactId>
    		</exclusion>
    	</exclusions>
    </dependency>

    <dependency>
    	<groupId>org.springframework.boot</groupId>
    	<artifactId>spring-boot-starter-undertow</artifactId>
    </dependency>
    ```

    ```java
    configurations {
        compile.exclude module: 'spring-boot-starter-tomcat'
    }

    dependencies {
    	implementation 'org.springframework.boot:spring-boot-starter-web'
    	implementation 'org.springframework.boot:spring-boot-starter-undertow'
    }
    ```

ê³¼ì—° í• ë§Œí•œê°€

- ë³„ ì°¨ì´ëŠ” ì—†ëŠ” ê²ƒ ê°™ë‹¤. JettyëŠ” ê²½ëŸ‰ì»¨í…Œì´ë„ˆ

ì¶œì²˜: [https://examples.javacodegeeks.com/enterprise-java/spring/tomcat-vs-jetty-vs-undertow-comparison-of-spring-boot-embedded-servlet-containers/](https://examples.javacodegeeks.com/enterprise-java/spring/tomcat-vs-jetty-vs-undertow-comparison-of-spring-boot-embedded-servlet-containers/) (í˜„ì¬ëŠ” ì•ˆì“°ëŠ” compileë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ì˜¤ë˜ëœ ë¸”ë¡œê·¸ì„ì„ ê°ì•ˆí•´ì„œ ë´ì•¼í•©ë‹ˆë‹¤)

### ì™¸ë¶€ì„¤ì • íŒŒì¼ì˜ ìš°ì„ ìˆœìœ„

ì™¸ë¶€ ì„¤ì •íŒŒì¼ì„ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë©° ìš°ì„  ìˆœìœ„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤

1. Command line arguments.

    ```java
    java -jar myproject.jar --spring.config.name=myproject
    ```

2. JNDI attributes from `java:comp/env`.
3. Java System properties (`System.getProperties()`).
4. OS environment variables.

    ```tsx
    MY_CUSTOM_K1="hello"
    ```

5. A `RandomValuePropertySource` that only has properties in `random.*`.
6. [Profile-specific application properties](https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/boot-features-external-config.html#boot-features-external-config-profile-specific-properties) outside of your packaged jar (`application-{profile}.properties` and YAML variants)
7. [Profile-specific application properties](https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/boot-features-external-config.html#boot-features-external-config-profile-specific-properties) packaged inside your jar (`application-{profile}.properties` and YAML variants) â† `Resources í´ë” ì•ˆì— ìˆëŠ” application.properties`
    - ë‹¤ë¥¸ ë³€ìˆ˜ë¥¼ ì´ìš©í•´ì„œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

        ```tsx
        my.custom.k1 = "hello"
        my.custom.k2 = ${my.custom.k1} "world"
        ```

    - ëœë¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

        ```java
        my.secret=${random.value}
        my.number=${random.int}
        my.bignumber=${random.long}
        my.number.less.than.ten=${random.int(10)}
        my.number.in.range=${random.int[1024,65536]}
        ```

    - @Value ì–´ë…¸í…Œì´ì…˜

        javaíŒŒì¼ì—ì„œ í•´ë‹¹íŒŒì¼ì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

        ```java
        public class .... {
        	@Value("${my.custom.key}")
        	String name;
        }
        ```

    - application.propertiesì—ì„œ ì„¤ì •í•œ ê°’ë“¤ì„ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì„œ beanìœ¼ë¡œ ë“±ë¡í•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

        ```tsx
        my.custom.k1 = "hello"
        my.custom.k2 = ${my.custom.k1} "world"
        ```

        application.propertiesê°€ ìœ„ì™€ ê°™ì„ ë•Œ

        ```java
        @Component
        @ConfigurationProperties(prefix="my")
        public class CustomProperties {
        	String k1;
        	String k2;
        	...  (getter, setter)
        }
        ```

        ìœ„ì™€ ê°™ì€ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ë©´

        ```java
        @Component
        public class ... {
        	
        	@Autowired
        	CustomProperties customProperties;
        	...
        ```

        ì´ë ‡ê²Œ ì£¼ì…ë°›ì•„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤

    - relaxed binding (ëŠìŠ¨í•œ ë°”ì¸ë”©)

        application.propertiesëŠ” env, argument, í´ë˜ìŠ¤ ë‚´ ë“± ì—¬ëŸ¬ ì¥ì†Œì—ì„œ ë®ì–´ì”Œì¼ ìˆ˜ ìˆëŠ” ê°’ì´ê¸° ë•Œë¬¸ì— ëŠìŠ¨í•œ ë°”ì¸ë”©ì„ ì§€ì›í•©ë‹ˆë‹¤

        ì˜ˆë¥¼ë“¤ì–´ 

        - ì‹œìŠ¤í…œë³€ìˆ˜ì—ì„  .ì„ ì‚¬ìš©í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤
        - javaì—ì„  camelCaseê°€ ì›ì¹™ì…ë‹ˆë‹¤

        ë”°ë¼ì„œ ë‹¤ìŒ 3ê°€ì§€ëŠ” ëª¨ë‘ ê°™ì€ ë³€ìˆ˜ë¡œ ì·¨ê¸‰ë©ë‹ˆë‹¤

        - person.firstName (í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” camelCase)
        - person.first-name (application.properties ì—ì„  ì´ë ‡ê²Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥)
        - PERSON_FIRST_NAME (ì‹œìŠ¤í…œ ë³€ìˆ˜)
    - ConfigurationProperties ê²€ì¦

        ConfigurationPeopertiesë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ ì„¤ì • ì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ê²½ìš°, ê²€ì¦ì„ ì§€ì›í•©ë‹ˆë‹¤

        ```java
        @Component
        @ConfigurationProperties(prefix="my")
        public class CustomProperties {
        	@NotNull
        	String k1;
        	String k2;
        	...  (getter, setter)
        }
        ```

        ìœ„ì™€ ê°™ì´ javax.validation ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ê±°ë‚˜ configurationPropertiesValidator ë¥¼ ë§Œë“¤ì–´ ê²€ì¦ë°©ë²•ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

8. Application properties outside of your packaged jar (`application.properties` and YAML variants).
9. Application properties packaged inside your jar (`application.properties` and YAML variants)
10.  `@PropertySource` annotations on your `@Configuration` classes.
11. Default properties (specified using `SpringApplication.setDefaultProperties`).

ì¶œì²˜: [https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/boot-features-external-config.html](https://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/html/boot-features-external-config.html)

- application.properties

ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ê¸°ë³¸ ì„¤ì •íŒŒì¼ì…ë‹ˆë‹¤ (application.yml ë°©ì‹ìœ¼ë¡œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)

application.propertiesë¥¼ javaíŒŒì¼ë¡œ ëŒ€ì²´í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤